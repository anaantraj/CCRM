package edu.ccrm.service;

import edu.ccrm.domain.Student;
import edu.ccrm.exception.StudentNotFoundException;

import java.util.List;
import java.util.stream.Collectors;

/**
 * Provides business logic for student management.
 */
public class StudentService {
    private final DataStore dataStore = DataStore.getInstance();

    public void addStudent(String regNo, String fullName, String email) {
        Student student = new Student(regNo, fullName, email);
        dataStore.addStudent(student);
    }

    public List<Student> getAllStudents() {
        return dataStore.getStudents().collect(Collectors.toList());
    }

    public Student findStudentByRegNo(String regNo) throws StudentNotFoundException {
        Student student = dataStore.getStudent(regNo);
        if (student == null) {
            throw new StudentNotFoundException("Student with registration number '" + regNo + "' not found.");
        }
        return student;
    }
}
